# route: cl2 -> server -> cl1

cl1:~$ sudo ip addr add 172.17.23.1/24 dev lo
cl1:~$ sudo ip addr add 172.17.13.1/24 dev lo
cl1:~$ ip a sh lo
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet 172.17.23.1/24 scope global lo
       valid_lft forever preferred_lft forever
    inet 172.17.13.1/24 scope global lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever


server:~$ sudo ip route add 172.17.13.1 dev eth3
server:~$ ping 172.17.13.1
PING 172.17.13.1 (172.17.13.1): 56 data bytes
64 bytes from 172.17.13.1: seq=0 ttl=42 time=3.821 ms
^C
--- 172.17.13.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.821/3.821/3.821 ms

# let's check route: cl2 -> server -> cl1
cl2:~$ ping 172.17.13.1
PING 172.17.13.1 (172.17.13.1): 56 data bytes
64 bytes from 172.17.13.1: seq=0 ttl=42 time=3.276 ms
^C
--- 172.17.13.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.276/3.276/3.276 ms
cl2:~$ traceroute 172.17.13.1
traceroute to 172.17.13.1 (172.17.13.1), 30 hops max, 46 byte packets
 1  one.one.one.one (1.1.1.1)  0.070 ms  0.978 ms  0.585 ms
 2  172.17.13.1 (172.17.13.1)  3.365 ms  1.063 ms  0.611 ms

# directly route: cl2 -> cl1 by intnet4

cl2:~$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.1.19    0.0.0.0         UG    0      0        0 eth1
1.1.1.0         0.0.0.0         255.255.255.0   U     0      0        0 eth1
10.0.2.0        0.0.0.0         255.255.255.0   U     0      0        0 eth0
172.16.3.0      0.0.0.0         255.255.255.0   U     0      0        0 eth2
172.17.13.1     192.168.1.19    255.255.255.255 UGH   0      0        0 eth1
192.168.1.0     192.168.1.19    255.255.255.0   UG    0      0        0 eth1
192.168.1.19    0.0.0.0         255.255.255.255 UH    0      0        0 eth1
cl2:~$ sudo ip addr add 172.17.23.1/24 dev lo
cl2:~$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.1.19    0.0.0.0         UG    0      0        0 eth1
1.1.1.0         0.0.0.0         255.255.255.0   U     0      0        0 eth1
10.0.2.0        0.0.0.0         255.255.255.0   U     0      0        0 eth0
172.16.3.0      0.0.0.0         255.255.255.0   U     0      0        0 eth2
172.17.13.1     192.168.1.19    255.255.255.255 UGH   0      0        0 eth1
192.168.1.0     192.168.1.19    255.255.255.0   UG    0      0        0 eth1
192.168.1.19    0.0.0.0         255.255.255.255 UH    0      0        0 eth1
cl2:~$ ping 172.17.23.1
PING 172.17.23.1 (172.17.23.1): 56 data bytes
64 bytes from 172.17.23.1: seq=0 ttl=42 time=0.281 ms
^C
--- 172.17.23.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.281/0.281/0.281 ms
cl2:~$ traceroute 172.17.23.1
traceroute to 172.17.23.1 (172.17.23.1), 30 hops max, 46 byte packets
 1  172.17.23.1 (172.17.23.1)  0.060 ms  0.082 ms  0.074 ms
cl2:~$

# delete previous routes
cl2:~$ sudo ip route del 172.17.13.1 via 192.168.1.19
server:~$ sudo ip route del 172.17.13.1 dev eth3
cl2:~$ ping 172.17.13.1
PING 172.17.13.1 (172.17.13.1): 56 data bytes
^C
--- 172.17.13.1 ping statistics ---
96 packets transmitted, 0 packets received, 100% packet loss

# 000 | 01101 & 000 | 10111 <= 11100000 mask <= 224 <= /19 cidr
# 172.17.0.0/19
# that need for additional networks areas, like 172.17.|28|.xxx etc

server:~$ sudo ip route add 172.17.0.0/19 via 1.1.1.1
server:~$ ping 172.17.13.1
PING 172.17.13.1 (172.17.13.1): 56 data bytes
64 bytes from 172.17.13.1: seq=0 ttl=42 time=5.529 ms
^C
--- 172.17.13.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.529/5.529/5.529 ms

# test with new cidr 172.17.0.0/19
# cl2 -> server (192.168.1.1 - 1.1.1.1 - 2.2.2.1) -> 172.17.13.1 (cl1 lo iface)

cl2:~$ ping 172.17.13.1
PING 172.17.13.1 (172.17.13.1): 56 data bytes
64 bytes from 172.17.13.1: seq=0 ttl=42 time=5.733 ms
64 bytes from 172.17.13.1: seq=1 ttl=42 time=1.580 ms
^C
--- 172.17.13.1 ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max = 1.580/3.656/5.733 ms
cl2:~$ traceroute 172.17.13.1
traceroute to 172.17.13.1 (172.17.13.1), 30 hops max, 46 byte packets
 1  2.2.2.1 (2.2.2.1)  1.750 ms  1.211 ms  1.296 ms
 2  172.17.13.1 (172.17.13.1)  0.060 ms  1.498 ms  0.848 ms
cl2:~$ traceroute 172.17.23.1
traceroute to 172.17.23.1 (172.17.23.1), 30 hops max, 46 byte packets
 1  2.2.2.1 (2.2.2.1)  0.065 ms  0.060 ms  0.055 ms
 2  172.17.23.1 (172.17.23.1)  0.912 ms  0.840 ms  0.370 ms
cl2:~$
